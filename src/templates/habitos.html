{% extends "base.html" %}
{% set body_class = "body-hobby" %}

{% block head %}
<title>Hábitos</title>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
<link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
{% endblock %}

{% block body %}
<!-- <nav class="navbar">
  <a href="{{ url_for('create_hobby') }}">Hobbies</a>
  <a href="{{ url_for('movies') }}">Películas</a>
  <a href="{{ url_for('create_schedule_item') }}">Mi horario</a>
  <a href="{{ url_for('habitos') }}" class="active">Hábitos</a>
  <a href="{{ url_for('tasks') }}">Lista de tareas</a>
</nav> -->

<div class="container-hobby-all">
  <div class="container-hobby">
    {# Mensajes de hábitos, solo estas categorías #}
    {% with all_msgs = get_flashed_messages(with_categories=true) %}
      {% if all_msgs %}
        {% for cat, msg in all_msgs %}
          {% if cat in ['habits_error','habits_ok'] %}
            <div class="alert {{ cat }}">{{ msg }}</div>
          {% endif %}
        {% endfor %}
      {% endif %}
    {% endwith %}

    <h1>Hábitos</h1>
    <p>En este apartado puedes agregar tus hábitos.</p>

    <form action="{{ url_for('create_habit') }}" method="post">
      <div class="form-group">
        <label for="name">Nombre del hábito *</label>
        <input class="textbox" id="name" name="name" type="text" required>
      </div>

      <div class="form-group">
        <label for="satisfaction_level">Nivel de satisfacción (0–10)</label>
        <input class="textbox" id="satisfaction_level" name="satisfaction_level" type="number" min="0" max="10" step="1">
      </div>

      <div class="form-group">
        <label for="ability">Habilidad</label>
        <input class="textbox" id="ability" name="ability" type="text" placeholder="Ej: Principiante, Intermedio...">
      </div>

      <div class="form-group">
        <label for="time">Tiempo semanal (h/sem)</label>
        <input class="textbox" id="time" name="time" type="number" min="0" max="168" step="0.5">
      </div>

      <button class="btn" type="submit">Guardar</button>
    </form>
  </div>

  <div class="container-hobby-search">
    <h1>Buscar Hábito</h1>
    <form action="{{ url_for('habitos') }}" method="get">
      <div class="form-group">
        <label for="q_name">Nombre</label>
        <input class="textbox" id="q_name" name="name" type="text" placeholder="Ej: Leer, Meditar...">
      </div>

      <div class="form-group">
        <label for="q_ability">Habilidad</label>
        <input class="textbox" id="q_ability" name="ability" type="text" placeholder="Ej: Principiante">
      </div>

      <button class="btn" type="submit">Buscar</button>
    </form>

    <h1>Resultados</h1>
    <table border="1" cellpadding="5" cellspacing="0">
      <thead>
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Nivel de satisfacción</th>
          <th>Habilidad</th>
          <th>Tiempo (h/sem)</th>
        </tr>
      </thead>
      <tbody>
        {% if habits is defined and habits|length %}
          {% for h in habits %}
          <tr>
            <td>{{ h.id }}</td>
            <td>{{ h.name }}</td>
            <td>{{ h.satisfaction_level or '-' }}</td>
            <td>{{ h.ability or '-' }}</td>
            <td>{{ h.time or '-' }}</td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="5" style="text-align:center; color: gray;">
              {% if searched %}No se encontraron hábitos con esos filtros{% else %}Busca un hábito para ver resultados{% endif %}
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
